---
title: "[클래스의 이해] 5. 메모리 모델의 개념"
excerpt: "Java Memory model에 대해 알아보자"
toc: true
toc_sticky: true
categories:
  - Java
tags:
  - java
  - Memory Model
  - 객체지향
last_modified_at: 2021-03-29 13:18:20
---

# 5. Java 메모리 모델
<span style="color:grey">[자바 : 클래스의 이해와 객체지향 프로그래밍]내용입니다.</span>
  
## 5-1. 자바 가상머신(JVM)은 운영체제 위에서 동작한다
  
JVM은 운영체제로부터 할당받은 메모리 공간을 이용해서 자기 자신도 실행하고, 자바 프로그램도 실행해야합니다.  
  
![이미지](/assets/images/Java_클래스의_이해/5강/memory1.png)

### 바이트코드(Bytecode)란?

고급언어인 자바 소스 코드를 중간코드로 컴파일한 것을 말하며,  
어셈블리어에 가까운 형태를 띄고 있습니다.  
  
**가상머신(JVM)이란?**  
> 컴파일러가 중간코드(Byte Code 또는 .class 파일)로 변환해주면, 이를 읽고 출력해주는 것이 JVM 입니다.
> ![이미지](/assets/images/Java_클래스의_이해/5강/memory12.png)
  
**바이트코드 예시**
![이미지](/assets/images/Java_클래스의_이해/5강/memory3.png)

## 5-2. 자바 가상머신의 메모리 모델
JVM은 메모리 공간 활용의 효율성을 높이기 위해  
다음과 같이 메모리 공간을 세 영역으로 구분하여 사용합니다.  
![이미지](/assets/images/Java_클래스의_이해/5강/memory2.png)
  
### 메서드 영역이란?
<u>'클래스 파일의 바이트 코드가 로드 되는 곳.'</u>  
즉, JVM이 시작할 때 생성되며, 모든 스레드가 공유하는 영역입니다.  
✔️ 바이트 코드와 Static으로 선언된 클래스 변수 등이 해당  

![이미지](/assets/images/Java_클래스의_이해/5강/memory4.png)

### 스택 영역이란?
<u>'매개변수, 지역변수가 할당되는 메모리 공간'</u>  
프로그램이 실행되는 도중에 임시로 할당되었다가 바로 이어서 소멸되는 특징이 있는 변수가 저장된다.  
✔️ 지역변수나 매개변수 등이 해당

![이미지](/assets/images/Java_클래스의_이해/5강/memory5.png)

> **스택의 흐름**  
> 스택에 할당된 지역 변수는 <u>해당 메서드를 빠져나가면 소멸됩니다.</u>  
> 이는 할당 및 소멸의 특성상 그 형태가 장작을 쌓는 것과 유사하며,  
> 그게 바로 **'스택(Stack)'** 으로 불리게 된 이유입니다.  
> 할당 및 소멸의 특성상 메서드 별 스택이 구분이 된다.  
![이미지](/assets/images/Java_클래스의_이해/5강/memory6.png)
![이미지](/assets/images/Java_클래스의_이해/5강/memory7.png)

### 힙 영역이란?
<u>'인스턴스(객체)가 생성되는 메모리 공간'</u>  
JVM에 의한 메모리 공간의 정리(Garbage Collection)가 이뤄지는 공간입니다.  
객체의 할당은 프로그래머👨‍💻가 하지만 소멸은 JVM🤖이 처리합니다.  
소멸의 대상은 <u>참조변수에 의한 참조가 전혀 이뤄지지 않는 인스턴스</u>이며,  
따라서 JVM은 인스턴스의 참조관계를 확인하고 소멸할 대상을 선정합니다.  
  
![이미지](/assets/images/Java_클래스의_이해/5강/memory8.png)

> **인스턴스의 소멸시기**를 알아보자.
![이미지](/assets/images/Java_클래스의_이해/5강/memory9.png)
참조 관계가 소멸 시 참조 변수는 객체의 위치가 어디인지 알 수 없게 됩니다.  
객체는 끊어진 채로 남아있게 되면서 Garbage collection의 수집 대상이 됩니다.  
![이미지](/assets/images/Java_클래스의_이해/5강/memory10.png)


### Garbage Collection에 대한 추가 설명
GC는 한 번도 발생하지 않을 수 있습니다.  
GC가 발생하면, 소멸의 대상이 되는 인스턴스는 결정되지만, 이것이 실제 소멸로 바로 이어지지는 않습니다.  
인스턴스의 실제 소멸로 이어지지 않은 상태에서 프로그램이 종료될 수 있으며, 종료시 인스턴스는 소멸됩니다.  
![이미지](/assets/images/Java_클래스의_이해/5강/memory11.png)
  
  
끝-!😋